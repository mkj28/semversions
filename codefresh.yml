version: '1.0'
steps:
  init-variables:
    title: Init variables
    image: alpine
    commands:
      - cf_export GITTOOLS_GITVERSION_TAG=v4.0.0-beta.12
      - cf_export GIT_BRANCH=${{CF_BRANCH}}

  build:
    title: Build Docker Image
    type: build
    image_name: mkj28/semversions
    working_directory: ./
    dockerfile: Dockerfile

  semver:
    image: gittools/gitversion:${{GITTOOLS_GITVERSION_TAG}}
    title: Setting Semversions
    commands:
      - ls
      - pwd
      - mono /usr/lib/GitVersion/GitVersion.exe . /showvariable SemVer
      - mono /usr/lib/GitVersion/GitVersion.exe . /output buildserver
